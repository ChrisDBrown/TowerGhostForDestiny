window.ua=navigator.userAgent,window.isNWJS="undefined"!=typeof require,window.isChrome=/Chrome/.test(ua)&&/Google Inc/.test(navigator.vendor)&&"undefined"!=typeof chrome,window.isFirefox=/firefox/i.test(ua),window.isIOS=/ios|iphone|ipod|ipad/i.test(ua),window.isiPad=/ipad/i.test(ua),window.isAndroid=/android/i.test(ua),window.isWindowsPhone=/iemobile/i.test(ua),window.isMobile=window.isIOS||window.isAndroid||window.isWindowsPhone,window.isKindle=/Kindle/i.test(ua)||/Silk/i.test(ua)||/KFTT/i.test(ua)||/KFOT/i.test(ua)||/KFJWA/i.test(ua)||/KFJWI/i.test(ua)||/KFSOWI/i.test(ua)||/KFTHWA/i.test(ua)||/KFTHWI/i.test(ua)||/KFAPWA/i.test(ua)||/KFAPWI/i.test(ua),window.isStaticBrowser=location.protocol.indexOf("http")>-1&&-1==location.href.indexOf("towerghostfordestiny.com/firefox"),window.isStaticBrowser&&(window.isMobile=window.isWindowsPhone=window.isAndroid=window.isIOS=window.isFirefox=window.isChrome=window.isNWJS=!1),"undefined"==typeof window.tgd&&(window.tgd={}),"undefined"==typeof tgd.dataDir&&(tgd.dataDir="data"),isWindowsPhone&&(window.requestFileSystem=function(){}),tgd.localLogging=location.href.indexOf("debug")>-1,tgd.localLog=function(msg){tgd.localLogging&&console.log(msg)},function(){function loadManifest(manifest,fromLocalStorage,timeout){function finishLoadingFromFS(){if(index++,index==loading.length){var el=document.createElement("style");el.type="text/css",el.innerHTML=cssContent,head.appendChild(el);var el=document.createElement("script");el.type="text/javascript",console.log("appending script"),el.innerHTML=scriptsContent,head.appendChild(el)}}function loadNextFromFS(index){if(loading.length-1>=index){var element=loading[index][0],source=loading[index][1];window.__fs.root.getFile(source,{},function(fileEntry){fileEntry.file(function(file){var reader=new FileReader;reader.onloadend=function(){index++,loadNextFromFS(index),"text/javascript"==element.type?scriptsContent=scriptsContent+"\n"+this.result.toString():cssContent=cssContent+"\n"+this.result.toString(),finishLoadingFromFS()},reader.readAsText(file)})},function(){})}}function loadScripts(){scripts.forEach(function(src){src&&("/"===src[0]&&(src=src.substr(1)),src=loadAsScript?manifest.root+src:"app/"+src,src.substr(-5).indexOf(".js")>-1?(el=document.createElement("script"),el.type="text/javascript",el.async=!1,el.defer=!0,loadAsScript?el.src=src:loading.push([el,src])):(el=document.createElement(loadAsScript?"link":"style"),el.rel="stylesheet",loadAsScript?el.href=src:loading.push([el,src]),el.type="text/css"),head.appendChild(el))}),loadAsScript||loadNextFromFS(count)}if(fromLocalStorage&&setTimeout(function(){window.BOOTSTRAP_OK||(console.warn("BOOTSTRAP_OK !== true; Resetting to original manifest.json..."),localStorage.removeItem("manifest"),location.reload())},timeout),!manifest.load)return void console.error("Manifest has nothing to load (manifest.load is empty).",manifest);manifest.root=manifest.root||"./";var el,loadAsScript=1==isFirefox&&"./"==manifest.root||!isFirefox,head=document.getElementsByTagName("head")[0],scripts=manifest.load.concat(),loading=(Date.now(),[]),count=0,index=0,scriptsContent="",cssContent="";manifest.root.length>0&&"/"!==manifest.root[manifest.root.length-1]&&(manifest.root+="/"),fromLocalStorage||localStorage.setItem("manifest",JSON.stringify(manifest)),"undefined"!=typeof window.cordova?document.addEventListener("deviceready",loadScripts,!1):loadAsScript?loadScripts():window.requestFileSystem(1,20971520,function(fs){window.__fs=fs,loadScripts()},function(){}),window.Manifest=manifest}window.pegasus=function(a,xhr){return xhr=new XMLHttpRequest,xhr.open("GET",a),a=[],xhr.onreadystatechange=xhr.then=function(onSuccess,onError,cb){if(onSuccess&&onSuccess.call&&(a=[onSuccess,onError]),4==xhr.readyState&&(cb=a[0|xhr.status/400])){var response;try{response=JSON.parse(xhr.responseText)}catch(e){console.log(e)}var result=200!==xhr.status&&0!==xhr.status||""===xhr.responseText?xhr:response;cb(result)}},xhr.send(),xhr},window.Manifest={};var manifest=JSON.parse(localStorage.getItem("manifest")),s=document.querySelector("script[manifest]");if(!manifest||manifest&&manifest.root&&"./"==manifest.root){var noQueryString=location.href.indexOf("?")>-1?location.href.split("?")[0]:location.href,url=noQueryString.replace(noQueryString.split("/")[noQueryString.split("/").length-1],"")+((s?s.getAttribute("manifest"):null)||"bootstrap.json")+"?now="+(new Date).getTime();pegasus(url).then(loadManifest,function(xhr){console.error("Could not download "+url+": "+xhr.status)})}else loadManifest(manifest,!0,s.getAttribute("timeout")||1e4)}();
//# sourceMappingURL=bootstrap.js.map